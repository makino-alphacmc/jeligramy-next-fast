# 製造マニュアル（手順書）体裁メモ

他画面の手順書を書くとき、共通パーツ（common）のファイル構成・項目構成に合わせるためのメモ。

---

## 1. ファイル構成

対象ごとに **1 フォルダ** を切り、その中に次のファイルを置く。

```
docs/manual/manufacture/
├── 手順書_体裁メモ.md     ← 本メモ（体裁の参照用）
└── <対象名>/              ← 例: common, top
    ├── README.md          ← 対象の概要・進め方・参照リンク
    ├── 00-design.md       ← 詳細設計（実装範囲・API・ファイル構成・仕様・環境変数・完了イメージ）
    ├── step1-backend.md   ← バックエンド実装手順（必要なら）
    ├── step2-frontend.md  ← フロントエンド実装手順（必要なら）
    ├── step3-integration.md ← 結合・動作確認
    └── （step4 以降は必要に応じて）
```

- ファイル名: `step<N>-<内容>.md`（例: step1-backend, step2-frontend）。
- バックのみ・フロントのみの対象なら、該当する Step だけ作る。

---

## 2. README.md の項目構成

| 順序 | 項目 | 内容 |
|------|------|------|
| 1 | タイトル | `# <対象名> 製造マニュアル` |
| 2 | 冒頭 1〜2 行 | このディレクトリの役割。単体テストは「機能ごと」である旨（任意）。 |
| 3 | 詳細設計・手順書の説明 | 詳細設計＝仕様・API・ファイル配置。手順書＝Step 単位で実施順に進める。 |
| 4 | 対象実装 | 表：対象名、フォルダ、概要。 |
| 5 | 進め方 | 00-design 確認 → step1 以降を順に実施。完了条件を満たしたら次へ。 |
| 6 | 参照 | 基本設計・API 一覧・低レベル設計などのリンク。 |

---

## 3. 00-design.md の項目構成

| 順序 | 項目 | 内容 |
|------|------|------|
| 1 | タイトル | `# <対象名> 詳細設計` |
| 2 | 冒頭 | 対象の説明と、参照ドキュメント（基本設計・API 一覧・低レベル設計）へのリンク。 |
| 3 | 1. 実装範囲 | 単体テストのタイミング（機能ごと）。表：区分（バックエンド／フロントエンド／本手順で扱わないもの）、内容。 |
| 4 | 2. API 詳細設計 | 各 API ごとに「2.1 名前」で小見出し。表：用途、メソッド、パス、認証、レスポンス 200/401 など。 |
| 5 | 3. バックエンド ファイル構成 | 想定するディレクトリ・ファイル一覧（ツリー形式）。 |
| 6 | 4. フロントエンド ファイル構成 | 想定するディレクトリ・ファイル一覧（ツリー形式）。 |
| 7 | 5. 画面・コンポーネント仕様 | 表：コンポーネント名、仕様要点（寸法・色・役割）。 |
| 8 | 6. 環境変数 | 表：変数名、置き場所、用途。 |
| 9 | 7. 完了イメージ | 手順完了時にどうなっているか（バック・フロント・画面の状態）を箇条書き。 |

---

## 4. stepN の共通フォーマット

各 Step は次の流れで書く。

| 順序 | 項目 | 内容 |
|------|------|------|
| 1 | タイトル | `# Step N: <区分> — <短い説明>`（例: Step 1: バックエンド — 共通 API 実装） |
| 2 | ゴール（完了条件） | チェックリスト形式 `- [ ] …`。読者が「できた」と判断できる条件を列挙。 |
| 3 | （N-1）. 前提 | 事前に揃えておくもの（ツール・バージョン・他 Step の完了など）。**「なぜ必要か」の長い解説は書かない。** |
| 4 | コードのつながり | この Step で触るファイル・処理の流れを簡潔な図（コードブロック）で示す。 |
| 5 | （N-2）以降. 各作業 | 見出し「（N-2）. <作業名>」。**手順** で番号付き手順、その下にコードブロック。 |
| 6 | コードブロック内コメント | 次のいずれかまたは複数を使う。**なぜ必要**・**なんのため**・**意味**（その行・そのブロックの役割）。 |
| 7 | 単体テスト | バックエンド Step の末尾：テストの追加方法と実行コマンド。フロントエンド Step の末尾：同様。 |
| 8 | トラブルシュート | 表：現象、確認すること。 |
| 9 | 締め | 「以上が完了したら **Step N+1** に進む。」 |

---

## 5. Step 別の項目構成（common の例）

### step1-backend.md

| 見出し | 内容 |
|--------|------|
| ゴール（完了条件） | 起動・API 動作・CORS・単体テスト通過など。 |
| 1-1. 前提 | ツール・カレントディレクトリ。 |
| コードのつながり（Step 1 の流れ） | テキスト図。 |
| 1-2. 依存関係の準備 | requirements.txt、仮想環境、pip install。 |
| 1-3. レスポンス用スキーマ | schemas/ とスキーマ定義。 |
| 1-4. 認証ルーター（または該当ルーター） | routers/ とエンドポイント実装。 |
| 1-5. アプリのエントリポイント | main.py と CORS・include_router。 |
| 1-6. 起動と動作確認 | 起動コマンド、curl 等での確認、OpenAPI。 |
| 1-7. 単体テスト（バックエンド） | pytest、TestClient、tests/ の作成と実行。 |
| 1-8. トラブルシュート | 表。 |

### step2-frontend.md

| 見出し | 内容 |
|--------|------|
| ゴール（完了条件） | レイアウト表示・テーマ・各パーツ・API 呼び出し・単体テスト通過など。 |
| 2-1. 前提 | 他 Step の完了、Next.js、UI 仕様参照。 |
| コードのつながり（Step 2 の流れ） | テキスト図。 |
| 2-2. 環境変数 | .env.local と変数説明。 |
| 2-3. API 呼び出し用ユーティリティ | lib/api.ts 等。 |
| 2-4. 共通レイアウト用コンポーネント | 各コンポーネントの作成（見出し 2-4 の下に 2, 3, 4… でコンポーネント名）。 |
| 2-5. ルートレイアウトの適用 | layout.tsx、page.tsx。 |
| 2-6. 動作確認 | 起動・ブラウザ確認の手順。 |
| 2-7. 単体テスト（フロントエンド） | Jest 設定、api.test、コンポーネント test、実行。 |
| 2-8. トラブルシュート | 表。 |

### step3-integration.md

| 見出し | 内容 |
|--------|------|
| ゴール（完了条件） | 同時起動・表示・API 動作・Logout など。 |
| 3-1. 同時起動 | 手順：ターミナル 2 つで backend / frontend 起動、ブラウザで開く。 |
| 3-2. 確認チェックリスト | 表：確認項目、期待。 |
| 3-3. API 確認（開発者ツール） | Network タブで API が呼ばれていることの確認。 |
| 3-4. 今後の拡張（本手順の外） | 箇条書き。締めの一文。 |

---

## 6. コード・コメントのルール

- **コードブロックの上または中**に、次のようなコメントを入れる。
  - **なぜ必要**: そのファイル・その処理がなぜいるか（役割）。
  - **なんのため**: どの機能や画面のためか（つながり）。
  - **意味**: その行・そのブロックが何をしているか（読み方）。
- 前提の「なぜこのフォルダが必要か」「この Step で何をするか」のような**長い説明段落は書かない**。必要ならコードのコメントで説明する。
- 手順は「**手順**」の見出しのあと、番号付きで「1. … 2. …」と書く。コードは fenced code block（```）で示す。

---

## 7. 他画面で体裁を合わせるときのチェック

- [ ] 対象フォルダに README.md / 00-design.md / step1〜 を用意したか
- [ ] README に「進め方」と「00 → step1 → step2 → …」の順序を書いたか
- [ ] 00-design に「実装範囲・API 詳細・ファイル構成・仕様・環境変数・完了イメージ」を揃えたか
- [ ] 各 Step に「ゴール（完了条件）」「前提」「コードのつながり」「手順＋コード」「単体テスト（該当する Step）」「トラブルシュート」「次 Step へ」を入れたか
- [ ] コードブロックに「なぜ必要」「なんのため」「意味」のコメントを付けたか
- [ ] 前提に「なぜ必要か」の長い段落を置いていないか

---

## 参照

- 実例: `docs/manual/manufacture/common/` 配下の README.md, 00-design.md, step1-backend.md, step2-frontend.md, step3-integration.md
